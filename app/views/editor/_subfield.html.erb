<%	tag_id = pe_field_name(tag_name, iterator, subfield, s_iterator) %>
<%
	read_only = false
	@editor_profile.each_subfield_for(tag_name) do |subfieldopt, field_settings|
		if subfieldopt == subfield
			read_only = field_settings["read_only"] != nil ? field_settings["read_only"] : false
		end
	end	
%>
<%- if (params['growfield'])  %>
	<textarea cols="100" class="pe_growfield subfield_entry serialize_marc" id="<%= tag_id %>" name="<%= tag_id %>"><%= h marc_subfield.content %></textarea>
<%- else %>
	<% if read_only %>
			<input class="subfield_entry"  disabled="disabled" size="<%= params['width'] -%>" type="text" value="<%= h marc_subfield.content %>"/>
			<input type="hidden" class="serialize_marc" id="<%= tag_id %>" name="<%= tag_id %>" value="<%= h marc_subfield.content %>"/>
	<% else %>
		<input class="subfield_entry serialize_marc" size="<%= params['width'] -%>" type="text" id="<%= tag_id %>" name="<%= tag_id %>" value="<%= h marc_subfield.content %>"/>
	<% end %>
<%- end %>

<script>
jQuery(function($){
	jquery_id = "<%= tag_id %>".replace(/(\[|\])/g, '\\$1');
   	$("#" + jquery_id).enableSelection();
});
</script>

<%- if (params['maskedinput']) %>
	<script>
	jQuery(function($){
		jquery_id = "<%= tag_id %>".replace(/(\[|\])/g, '\\$1');
	   	$("#" + jquery_id).mask("<%= params['maskedinput'].html_safe-%>", {placeholder:" "});
	});
	</script>
	
<%- elsif (params['validate']) %>
<!--
	<script>
		jQuery(function($){
			jquery_id = "<%= tag_id %>".replace(/(\[|\])/g, '\\$1');
			<%- params['validate'].each do |valid| %>
				$("#" + jquery_id).rules("add", { <%= valid['rule'] %>: <%= raw valid['value'] %>, 
					messages: { <%= valid['rule'] %>: "<%= tag_name.html_safe-%> $<%= subfield.html_safe-%>: <%= valid['msg'].html_safe -%>" }});
			<%- end %>
		});
	</script>
-->
<%- end %>